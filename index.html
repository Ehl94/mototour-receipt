<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recibo MOTOTOUR - Moto Tribu</title>
    <style>
        @media print {
            @page {
                size: letter;
                margin: 15mm 20mm;
            }
            
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            body { 
                margin: 0;
                padding: 0;
                font-size: 11pt;
                line-height: 1.3;
                background: white !important;
            }
            
            .no-print { 
                display: none !important; 
            }
            
            .recibo {
                background: white !important;
                box-shadow: none !important;
                padding: 15pt !important;
                margin: 0 !important;
                max-width: none !important;
                width: 100% !important;
            }
            
            .header {
                page-break-inside: avoid;
                margin-bottom: 15pt;
            }
            
            .logo-centered {
                display: flex !important;
                flex-direction: column !important;
                align-items: center !important;
                justify-content: center !important;
                text-align: center !important;
            }
            
            .moto-logo {
                height: 80pt !important;
                width: auto !important;
                max-width: 80pt !important;
                margin-bottom: 8pt !important;
            }
            
            .logo-centered h2 {
                font-size: 12pt !important;
                margin: 0 !important;
                border: 1pt solid #999 !important;
                border-radius: 3pt !important;
                padding: 6pt 12pt !important;
                background-color: #f9f9f9 !important;
                display: inline-block !important;
            }
            
            .seccion {
                page-break-inside: avoid;
                margin-bottom: 15pt !important;
            }
            
            .seccion-titulo {
                font-size: 10pt !important;
                padding: 4pt 8pt !important;
                margin-bottom: 8pt !important;
            }
            
            .campo {
                margin-bottom: 6pt !important;
                font-size: 9pt !important;
            }
            
            .campo-label {
                min-width: 120pt !important;
                font-size: 9pt !important;
            }
            
            .tabla-resumen {
                font-size: 9pt !important;
                margin-top: 5pt !important;
            }
            
            .tabla-resumen td {
                padding: 4pt !important;
            }
            
            .condiciones {
                font-size: 8pt !important;
                line-height: 1.2 !important;
                padding: 8pt !important;
                margin: 10pt 0 !important;
                page-break-before: auto;
            }
            
            .condiciones ul {
                margin: 5pt 0 !important;
                padding-left: 12pt !important;
            }
            
            .condiciones li {
                margin-bottom: 2pt !important;
            }
            
            .firmas {
                margin-top: 25pt !important;
                margin-bottom: 10pt !important;
                page-break-inside: avoid;
            }
            
            .linea-firma {
                margin-top: 30pt !important;
                font-size: 9pt !important;
            }
            
            .footer {
                font-size: 8pt !important;
                margin-top: 15pt !important;
                padding-top: 10pt !important;
            }
            
            .recibo-numero {
                font-size: 9pt !important;
                margin-bottom: 10pt !important;
            }
            
            /* Forzar salto de página después de la sección de pago */
            .condiciones {
                page-break-before: page !important;
            }
            
            input, select {
                border: none !important;
                border-bottom: 0.75pt solid #999 !important;
                background: transparent !important;
                font-size: 9pt !important;
                padding: 3pt 0 !important;
                margin: 0 !important;
                display: block !important;
                box-shadow: none !important;
                -webkit-appearance: none !important;
                -moz-appearance: none !important;
                appearance: none !important;  /* Una sola declaración */
            }
            
            .campo-valor {
                border: none !important;
                background: none !important;
                padding: 0 !important;
                margin: 0 !important;
            }
            
            .saldo-input {
                background: #333 !important;
                color: rgb(19, 19, 19) !important;
                font-weight: bold !important;
                border: none !important;
                border-bottom: none !important;
            }
            
            /* Ajustes específicos para evitar cortes */
            .campo-valor {
                word-wrap: break-word;
                overflow-wrap: break-word;
            }
        }
        
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .recibo {
            background: white;
            padding: 30px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #333;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .logo-centered {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .moto-logo {
            height: 150px;
            width: auto;
            object-fit: contain;
            filter: contrast(1.1);
            margin-bottom: 15px;
        }
        
        .logo-centered h2 {
            margin: 0;
            color: #333;
            font-size: 20px;
            font-weight: normal;
            border: 2px solid #999;
            border-radius: 5px;
            padding: 10px 20px;
            background-color: #f9f9f9;
            display: inline-block;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .moto-logo {
                height: 130px;
            }
            
            .logo-centered h2 {
                font-size: 18px;
                padding: 6px 14px;
            }
        }
        
        .recibo-numero {
            margin-bottom: 10px;
            font-size: 14px;
            text-align: center;
        }

        .numero-fecha-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
        }

        .numero-operacion,
        .fecha-operacion {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 250px
        }

        .numero-operacion input {
            width: 100px;
        }

        .fecha-operacion input {
            width: 130px;
        }
        
        .seccion {
            margin-bottom: 20px;
        }
        
        .seccion-titulo {
            background: #333;
            color: white;
            padding: 8px 15px;
            margin-bottom: 15px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .campo {
            margin-bottom: 12px;
            display: flex;
            align-items: baseline;
            gap: 10px;
        }
        
        .campo-label {
            font-weight: bold;
            min-width: 180px;
            color: #333;
        }
        
        .campo-valor {
            flex: 1;
            padding-left: 10px;
        }
        
        .tabla-resumen {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .tabla-resumen input,
        .tabla-resumen select {
            display: inline-block !important;
            width: calc(100% - 30px) !important;
            margin-left: 5px !important;
            border: none !important;
            padding: 0 !important;
            vertical-align: middle !important;
        }
        
        .tabla-resumen td {
            padding: 8px !important;
            border: 1px solid #ddd !important;
            white-space: nowrap !important;
            vertical-align: middle !important;
        }
        
        .tabla-resumen td:first-child {
            font-weight: bold;
            background: #f9f9f9;
            width: 40%;
        }
        
        .total {
            background: #333 !important; /* Fondo más oscuro */
            color: white !important;
            font-size: 16px !important;
        }
        
        .total td {
            color: rgb(37, 36, 36) !important;
            font-weight: bold !important;
        }
        
        .total input,
        .saldo-input {
            background: #333 !important;
            color: white !important;
            font-weight: bold !important;
            font-size: 16px !important;
            border: none !important;
            width: calc(100% - 20px) !important;
        }
        
        /* Asegurar que el signo $ también sea visible */
        .total td:nth-child(2) {
            color: white !important;
        }
        
        /* Mantener el color blanco incluso al enfocar */
        .total input:focus {
            color: white !important;
            background: transparent !important;
            outline: none !important;
        }
        
        .saldo-input {
            background: transparent !important;
            color: white !important;  /* Cambia el color del input a blanco */
            font-weight: bold !important;
            font-size: 16px !important;
            border: none !important;
        }
        
        .condiciones {
            background: #f9f9f9;
            padding: 12px;
            border-left: 4px solid #d32f2f;
            margin: 15px 0;
            font-size: 12px;
            line-height: 1.5;
        }
        
        .condiciones ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .firmas {
            display: flex;
            justify-content: space-around;
            margin-top: 50px;
            margin-bottom: 20px;
        }
        
        .firma {
            text-align: center;
            width: 40%;
        }
        
        .linea-firma {
            border-top: 2px solid #333;
            margin-top: 60px;
            padding-top: 8px;
            font-weight: bold;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            font-size: 12px;
            color: #666;
        }
        
        .botones {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            background: #d32f2f;
            color: white;
            border: none;
            padding: 12px 30px;
            margin: 0 10px;
            cursor: pointer;
            font-size: 14px;
            border-radius: 4px;
        }
        
        button:hover {
            background: #b71c1c;
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        input, select {
            border: none !important;
            border-bottom: 1px solid #999 !important;
            background: transparent !important;
            font-family: Arial, sans-serif !important;
            font-size: 14px !important;
            width: 100% !important;
            padding: 4px 0 !important;
            margin: 0 !important;
            display: block !important;
            box-shadow: none !important;
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
            appearance: none !important;
        }
        
        input:focus, select:focus {
            outline: none;
            border-bottom: 2px solid #d32f2f;
        }
    </style>
</head>
<body>
    <div class="botones no-print">
        <button onclick="imprimirPDF()">🖨️ Imprimir / Guardar como PDF</button>
        <button onclick="descargarWord()">📄 Descargar como Word</button>
    </div>
    
    <div class="recibo" id="recibo">
        <div class="header">
            <div class="logo-centered">
                <img src="./assets/img/logo.png" alt="MOTO TRIBU Logo" class="moto-logo">
                <h2>COMPROBANTE DE RESERVA</h2>
            </div>
        </div>
        
        <div class="recibo-numero">
            <div class="numero-fecha-container">
                <div class="numero-operacion">
                    <strong>N° DE OPERACIÓN:</strong> <input type="text" id="recibo_num" placeholder="0000">
                </div>
                <div class="fecha-operacion">
                    <strong>Fecha:</strong> <input type="date" id="fecha_emision">
                </div>
            </div>
        </div>
        
        <div class="seccion">
            <div class="seccion-titulo">DATOS DE LA ORGANIZADORA</div>
            <div class="campo">
                <span class="campo-label">Nombre / Razón Social:</span>
                <span class="campo-valor"><input type="text" id="tour_nombre" value="ALEXANDRA MERCEDES EREMA"></span>
            </div>
            <div class="campo">
                <span class="campo-label">CUIT / CUIL:</span>
                <span class="campo-valor"><input type="text" id="org_cuit" value="27-40099978-9"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Domicilio:</span>
                <span class="campo-valor"><input type="text" id="org_domicilio" value="FRENCH N°977"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Teléfono / WhatsApp:</span>
                <span class="campo-valor"><input type="text" id="org_telefono" value="+542216400709"></span>
            </div>
        </div>
        
        <div class="seccion">
            <div class="seccion-titulo">DATOS DEL CLIENTE / RESERVANTE</div>
            <div class="campo">
                <span class="campo-label">Nombre y Apellido:</span>
                <span class="campo-valor"><input type="text" id="cli_nombre"></span>
            </div>
            <div class="campo">
                <span class="campo-label">DNI / Pasaporte:</span>
                <span class="campo-valor"><input type="text" id="cli_dni"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Domicilio:</span>
                <span class="campo-valor"><input type="text" id="cli_domicilio"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Teléfono / Celular:</span>
                <span class="campo-valor"><input type="text" id="cli_telefono"></span>
            </div>
        </div>
        
        <div class="seccion">
            <div class="seccion-titulo">DETALLES DE LA RESERVA</div>
            <div class="campo">
                <span class="campo-label">Tour:</span>
                <span class="campo-valor"><input type="text" id="tour_nombre" value="MOTOTOUR — Moto Tribu"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Fecha del Tour:</span>
                <span class="campo-valor"><input type="date" id="tour_fecha"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Hora de encuentro:</span>
                <span class="campo-valor"><input type="time" id="tour_hora"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Duración:</span>
                <span class="campo-valor"><input type="text" id="tour_duracion" value="6 días / 5 noches"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Cantidad de personas:</span>
                <span class="campo-valor"><input type="number" id="tour_personas" min="1"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Tipo de habitación:</span>
                <span class="campo-valor">
                    <select id="tour_habitacion">
                        <option value="">Seleccionar...</option>
                        <option value="simple">Simple</option>
                        <option value="doble">Doble</option>
                        <option value="triple">Triple</option>
                        <option value="matrimonial">Matrimonial</option>
                    </select>
                </span>
            </div>
            <div class="campo">
                <span class="campo-label">Tipo de moto:</span>
                <span class="campo-valor"><input type="text" id="tour_moto"></span>
            </div>
            <div class="campo">
                <span class="campo-label">Servicios incluidos:</span>
                <span class="campo-valor"><input type="text" id="tour_servicios" value="Alojamiento, moto, traslados, desayunos y actividades"></span>
            </div>
        </div>
        
        <div class="seccion">
            <div class="seccion-titulo">RESUMEN DE PAGO</div>
            <table class="tabla-resumen">
                <tr>
                    <td>Precio por persona</td>
                    <td>$ <input type="text" id="pago_precio"></td>
                </tr>
                <tr>
                    <td>Cantidad de personas</td>
                    <td><input type="number" id="pago_cantidad" min="1"></td>
                </tr>
                <tr>
                    <td>Subtotal</td>
                    <td>$ <input type="text" id="pago_subtotal"></td>
                </tr>
                <tr>
                    <td>Seña / Anticipo abonado</td>
                    <td>$ <input type="text" id="pago_sena"></td>
                </tr>
                <tr>
                    <td>Fecha de pago de seña</td>
                    <td><input type="date" id="pago_fecha_sena"></td>
                </tr>
                <tr>
                    <td>Método de pago</td>
                    <td>
                        <select id="pago_metodo">
                            <option value="">Seleccionar...</option>
                            <option value="efectivo">Efectivo</option>
                            <option value="transferencia">Transferencia bancaria</option>
                            <option value="mercadopago">MercadoPago</option>
                            <option value="tarjeta">Tarjeta de crédito/débito</option>
                        </select>
                    </td>
                </tr>
                <tr class="total">
                    <td>SALDO PENDIENTE</td>
                    <td>$ <input type="text" id="pago_saldo" class="saldo-input"></td>
                </tr>
            </table>
        </div>
        
        <div class="condiciones">
            <strong>CONDICIONES GENERALES Y POLÍTICA DE CANCELACIÓN:</strong>
            <ul>
                <li>La reserva queda confirmada una vez abonada la seña establecida.</li>
                <li>El saldo restante debe ser abonado antes del inicio del tour.</li>
                <li><strong>Cancelaciones:</strong>
                    <ul>
                        <li>Con más de 30 días de anticipación: devolución del 90% de la seña.</li>
                        <li>Entre 10 y 30 días de anticipación: devolución del 60% de la seña.</li>
                        <li>Menos de 10 días de anticipación: sin devolución.</li>
                    </ul>
                </li>
                <li>La organizadora no se responsabiliza por daños ocasionados por mal uso de la motocicleta.</li>
                <li>El cliente debe contar con licencia de conducir vigente.</li>
                <li>Las condiciones climáticas pueden modificar el itinerario sin previo aviso.</li>
            </ul>
        </div>
        
        <div class="firmas">
            <div class="firma">
                <div class="linea-firma">Firma del Cliente</div>
                <div style="font-size: 12px;">DNI:_________________</div>
            </div>
            <div class="firma">
                <div class="linea-firma">Firma de la Organizadora</div>
                <div style="font-size: 12px;">DNI: 400-999-78 </div>
            </div>
        </div>
        
        <div class="footer">
            <p><strong>MOTOTOUR — Moto Tribu</strong></p>
            <p>Para consultas adicionales o condiciones completas del servicio, contactar a la organizadora.</p>
        </div>
    </div>
    
    <script>
        function imprimirPDF() {
            // Ocultar elementos que no deben imprimirse
            const botones = document.querySelector('.botones');
            if (botones) botones.style.display = 'none';
            
            // Optimizar para impresión
            document.body.style.margin = '0';
            document.body.style.padding = '0';
            
            // Imprimir
            window.print();
            
            // Restaurar elementos después de imprimir
            setTimeout(() => {
                if (botones) botones.style.display = 'block';
                document.body.style.margin = '';
                document.body.style.padding = '';
            }, 1000);
        }
        
        function descargarWord() {
            const recibo = document.getElementById('recibo').cloneNode(true);
            
            // Reemplazar todos los inputs con sus valores
            const inputs = recibo.querySelectorAll('input, select');
            inputs.forEach(input => {
                const span = document.createElement('span');
                span.textContent = input.value || '_______________';
                span.style.borderBottom = '1px solid #999';
                span.style.display = 'inline-block';
                span.style.minWidth = '100px';
                span.style.padding = '2px 5px';
                input.parentNode.replaceChild(span, input);
            });
            
            // Crear el HTML de forma más segura
            const htmlContent = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">' +
                '<head><meta charset="utf-8"><title>Recibo MOTOTOUR</title>' +
                '<style>' +
                'body { font-family: Arial, sans-serif; padding: 40px; }' +
                '.header { text-align: center; border-bottom: 3px solid #333; padding-bottom: 20px; margin-bottom: 30px; }' +
                '.seccion-titulo { background: #333; color: white; padding: 8px 15px; margin-bottom: 15px; font-weight: bold; }' +
                '.campo { margin-bottom: 12px; }' +
                '.tabla-resumen { width: 100%; border-collapse: collapse; margin-top: 10px; }' +
                '.tabla-resumen td { padding: 8px; border: 1px solid #ddd; }' +
                '</style></head>' +
                '<body>' + recibo.innerHTML + '</body></html>';
            
            const blob = new Blob(['\ufeff', htmlContent], {
                type: 'application/msword'
            });
            
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Recibo_MOTOTOUR_MotoTribu.doc';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>